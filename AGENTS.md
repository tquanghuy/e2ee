# Context for Agents

This repository `e2ee` is a Go SDK for End-to-End Encryption. It was originally generated by an AI and follows specific conventions that MUST be maintained.

## Core Terminology

- **Identity Keys**: Ed25519 keys used for signing and long-term user identity.
- **Exchange Keys**: X25519 keys used for ECDH key exchange and encryption.
- **Encrypt/Decrypt**: The primary operations. `Seal/Open` are deprecated terms in this codebase.

## Security Model

- **Authenticated Encryption**: We use a **Sign-then-Encrypt** scheme.
    - **Encrypt**: Signs the plaintext with the sender's `IdentityKey`, then encrypts the (message + signature) using XChaCha20-Poly1305 (derived from `ExchangeKey` ECDH).
    - **Decrypt**: Decrypts the ciphertext, then verifies the signature against the sender's `IdentityKey`.
- **Forward Secrecy**: Every message uses a fresh ephemeral key pair generated by the sender.

## Project Structure

- Root package (`e2ee`): All core functionality including key generation, encryption, decryption, signing, and verification.
- `examples/`: Usage examples.
- `doc.go`: Root package documentation.

## Development Rules

1.  **No Global State**: Keep packages stateless.
2.  **Secure Defaults**: Do not expose unsafe primitives (e.g., raw AES) without a high-level wrapper.
3.  **Testing**: Always add unit tests in `_test.go` files. Run with `go test ./...`.
4.  **Formatting**: Follow standard Go formatting.

## Verification

When making changes, verify using the simple chat example:
```bash
go run examples/simple-chat/main.go
```
